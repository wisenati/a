<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IMO State - Admin Dashboard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-storage-compat.js"></script>
    <style>
      :root {
        --primary-color: #0056b3;
        --primary-light: #e6f0ff;
        --secondary-color: #003366;
        --accent-color: #ffcc00;
        --light-color: #f8f9fa;
        --dark-color: #343a40;
        --success-color: #28a745;
        --warning-color: #ffc107;
        --error-color: #dc3545;
        --gray-light: #e9ecef;
        --gray-medium: #adb5bd;
        --gray-dark: #495057;
        --border-radius: 8px;
        --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        --transition: all 0.3s ease;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background-color: #f5f7fa;
        color: var(--dark-color);
        line-height: 1.6;
      }

      .dashboard-container {
        display: grid;
        grid-template-columns: 250px 1fr;
        min-height: 100vh;
      }

      /* Sidebar Styles */
      .sidebar {
        background: var(--secondary-color);
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 10;
        color: white;
      }

      .sidebar-header {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        text-align: center;
      }

      .sidebar-logo {
        width: 120px;
        height: auto;
      }

      .admin-badge {
        background-color: var(--accent-color);
        color: var(--secondary-color);
        font-size: 0.7rem;
        font-weight: 600;
        padding: 0.2rem 0.5rem;
        border-radius: 12px;
        display: inline-block;
        margin-top: 0.5rem;
      }

      .sidebar-nav {
        padding: 1.5rem 0;
      }

      .nav-section {
        margin-bottom: 1rem;
      }

      .nav-section-title {
        padding: 0.5rem 1.5rem;
        font-size: 0.8rem;
        text-transform: uppercase;
        color: var(--gray-medium);
        letter-spacing: 1px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        padding: 0.8rem 1.5rem;
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: var(--transition);
      }

      .nav-item:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
      }

      .nav-item.active {
        background-color: rgba(255, 255, 255, 0.15);
        color: white;
        border-left: 3px solid var(--accent-color);
      }

      .nav-item i {
        margin-right: 0.8rem;
        font-size: 1.1rem;
        width: 20px;
        text-align: center;
      }

      .sidebar-footer {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        text-align: center;
      }

      .admin-profile {
        display: flex;
        align-items: center;
        padding: 0.5rem 1rem;
      }

      .admin-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background-color: var(--accent-color);
        color: var(--secondary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        margin-right: 0.8rem;
      }

      .admin-info {
        flex: 1;
        text-align: left;
      }

      .admin-name {
        font-weight: 500;
        font-size: 0.9rem;
        margin-bottom: 0.1rem;
        color: white;
      }

      .admin-role {
        font-size: 0.75rem;
        color: var(--gray-medium);
      }

      /* Main Content Styles */
      .main-content {
        padding: 1.5rem;
        background-color: #f5f7fa;
        overflow-y: auto;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .page-title h1 {
        font-size: 1.5rem;
        color: var(--secondary-color);
      }

      .page-title p {
        font-size: 0.9rem;
        color: var(--gray-medium);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .notification-btn {
        position: relative;
        background: none;
        border: none;
        font-size: 1.2rem;
        color: var(--gray-dark);
        cursor: pointer;
      }

      .notification-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: var(--error-color);
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .logout-btn {
        background: none;
        border: none;
        color: var(--error-color);
        cursor: pointer;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* Dashboard Overview */
      .dashboard-overview {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .stat-card {
        background: white;
        border-radius: var(--border-radius);
        padding: 1.5rem;
        box-shadow: var(--box-shadow);
        transition: var(--transition);
      }

      .stat-card:hover {
        transform: translateY(-5px);
      }

      .stat-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .stat-icon.users {
        background-color: rgba(0, 86, 179, 0.1);
        color: var(--primary-color);
      }

      .stat-icon.complaints {
        background-color: rgba(255, 204, 0, 0.1);
        color: var(--warning-color);
      }

      .stat-icon.resolved {
        background-color: rgba(40, 167, 69, 0.1);
        color: var(--success-color);
      }

      .stat-icon.pending {
        background-color: rgba(220, 53, 69, 0.1);
        color: var(--error-color);
      }

      .stat-value {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 0.2rem;
      }

      .stat-label {
        color: var(--gray-medium);
        font-size: 0.9rem;
      }

      .stat-change {
        display: flex;
        align-items: center;
        font-size: 0.8rem;
        margin-top: 0.5rem;
      }

      .stat-change.positive {
        color: var(--success-color);
      }

      .stat-change.negative {
        color: var(--error-color);
      }

      .stat-change i {
        margin-right: 0.3rem;
      }

      /* Content Sections */
      .content-section {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.2rem 1.5rem;
        border-bottom: 1px solid var(--gray-light);
      }

      .section-title {
        font-weight: 600;
        color: var(--secondary-color);
        display: flex;
        align-items: center;
      }

      .section-title i {
        margin-right: 0.5rem;
        color: var(--primary-color);
      }

      .section-actions {
        display: flex;
        gap: 0.8rem;
      }

      .action-btn {
        background: none;
        border: 1px solid var(--gray-light);
        border-radius: 4px;
        padding: 0.4rem 0.8rem;
        font-size: 0.85rem;
        color: var(--gray-dark);
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .action-btn:hover {
        background-color: var(--gray-light);
      }

      .action-btn.primary {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
      }

      .action-btn.primary:hover {
        background-color: var(--secondary-color);
        border-color: var(--secondary-color);
      }

      .section-body {
        padding: 1.5rem;
      }

      /* Tabs */
      .tabs {
        display: flex;
        border-bottom: 1px solid var(--gray-light);
      }

      .tab {
        padding: 0.8rem 1.5rem;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 500;
        color: var(--gray-dark);
        position: relative;
      }

      .tab.active {
        color: var(--primary-color);
      }

      .tab.active::after {
        content: "";
        position: absolute;
        bottom: -1px;
        left: 0;
        right: 0;
        height: 2px;
        background-color: var(--primary-color);
      }

      .tab-content {
        display: none;
        padding: 1.5rem;
      }

      .tab-content.active {
        display: block;
      }

      /* Tables */
      .table-container {
        overflow-x: auto;
      }

      .admin-table {
        width: 100%;
        border-collapse: collapse;
      }

      .admin-table th,
      .admin-table td {
        padding: 0.8rem 1rem;
        text-align: left;
        border-bottom: 1px solid var(--gray-light);
      }

      .admin-table th {
        font-weight: 600;
        color: var(--secondary-color);
        background-color: var(--light-color);
      }

      .admin-table tr:hover {
        background-color: var(--primary-light);
      }

      .table-actions {
        display: flex;
        gap: 0.5rem;
      }

      .table-action-btn {
        background: none;
        border: none;
        font-size: 0.9rem;
        cursor: pointer;
        width: 28px;
        height: 28px;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
      }

      .table-action-btn.view {
        color: var(--primary-color);
        background-color: rgba(0, 86, 179, 0.1);
      }

      .table-action-btn.edit {
        color: var(--warning-color);
        background-color: rgba(255, 204, 0, 0.1);
      }

      .table-action-btn.delete {
        color: var(--error-color);
        background-color: rgba(220, 53, 69, 0.1);
      }

      .table-action-btn:hover {
        opacity: 0.8;
      }

      /* Status Badges */
      .status-badge {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
      }

      .status-pending {
        background-color: rgba(255, 204, 0, 0.1);
        color: var(--warning-color);
      }

      .status-resolved {
        background-color: rgba(40, 167, 69, 0.1);
        color: var(--success-color);
      }

      .status-new {
        background-color: rgba(220, 53, 69, 0.1);
        color: var(--error-color);
      }

      .status-active {
        background-color: rgba(40, 167, 69, 0.1);
        color: var(--success-color);
      }

      .status-inactive {
        background-color: rgba(173, 181, 189, 0.1);
        color: var(--gray-medium);
      }

      /* Search and Filter */
      .search-filter {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .search-box {
        flex: 1;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 0.6rem 1rem 0.6rem 2.5rem;
        border: 1px solid var(--gray-light);
        border-radius: 4px;
        font-size: 0.9rem;
      }

      .search-icon {
        position: absolute;
        left: 0.8rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-medium);
      }

      .filter-dropdown {
        position: relative;
      }

      .filter-btn {
        background: white;
        border: 1px solid var(--gray-light);
        border-radius: 4px;
        padding: 0.6rem 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        font-size: 0.9rem;
      }

      .filter-dropdown-content {
        position: absolute;
        right: 0;
        top: 100%;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        padding: 0.5rem 0;
        min-width: 180px;
        z-index: 100;
        display: none;
      }

      .filter-dropdown:hover .filter-dropdown-content {
        display: block;
      }

      .filter-option {
        padding: 0.5rem 1rem;
        cursor: pointer;
        transition: var(--transition);
      }

      .filter-option:hover {
        background-color: var(--primary-light);
      }

      /* Pagination */
      .pagination {
        display: flex;
        justify-content: center;
        margin-top: 1.5rem;
        gap: 0.5rem;
      }

      .page-item {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 0.9rem;
      }

      .page-item:hover {
        background-color: var(--gray-light);
      }

      .page-item.active {
        background-color: var(--primary-color);
        color: white;
      }

      .page-item.disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* Charts */
      .chart-container {
        height: 300px;
        margin-bottom: 1.5rem;
      }

      .chart-legend {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin-top: 1rem;
      }

      .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.85rem;
      }

      .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 2px;
        margin-right: 0.5rem;
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background: white;
        border-radius: var(--border-radius);
        width: 90%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transform: translateY(20px);
        transition: var(--transition);
      }

      .modal-overlay.active .modal {
        transform: translateY(0);
      }

      .modal-header {
        padding: 1.5rem;
        border-bottom: 1px solid var(--gray-light);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-title {
        font-weight: 600;
        color: var(--secondary-color);
      }

      .modal-close {
        background: none;
        border: none;
        font-size: 1.2rem;
        cursor: pointer;
        color: var(--gray-medium);
      }

      .modal-body {
        padding: 1.5rem;
      }

      .modal-footer {
        padding: 1rem 1.5rem;
        border-top: 1px solid var(--gray-light);
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
      }

      .modal-btn {
        padding: 0.6rem 1.2rem;
        border-radius: 4px;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
      }

      .modal-btn.cancel {
        background: white;
        border: 1px solid var(--gray-light);
        color: var(--gray-dark);
      }

      .modal-btn.cancel:hover {
        background-color: var(--gray-light);
      }

      .modal-btn.submit {
        background-color: var(--primary-color);
        color: white;
        border: none;
      }

      .modal-btn.submit:hover {
        background-color: var(--secondary-color);
      }

      .modal-btn.delete {
        background-color: var(--error-color);
        color: white;
        border: none;
      }

      .modal-btn.delete:hover {
        background-color: #bd2130;
      }

      /* Form Elements */
      .form-group {
        margin-bottom: 1.2rem;
      }

      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--gray-dark);
      }

      .form-control {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid var(--gray-light);
        border-radius: 4px;
        font-size: 0.9rem;
        transition: var(--transition);
      }

      .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        outline: none;
      }

      textarea.form-control {
        min-height: 120px;
        resize: vertical;
      }

      .select-wrapper {
        position: relative;
      }

      .select-wrapper::after {
        content: "\f078";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        top: 50%;
        right: 15px;
        transform: translateY(-50%);
        color: var(--gray-medium);
        pointer-events: none;
      }

      select.form-control {
        appearance: none;
        padding-right: 2.5rem;
      }

      /* Loading Spinner */
      .loading-spinner {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2rem;
      }

      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(0, 86, 179, 0.1);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Responsive Design */
      @media (max-width: 992px) {
        .dashboard-container {
          grid-template-columns: 70px 1fr;
        }

        .sidebar-header {
          padding: 1rem 0.5rem;
        }

        .sidebar-logo {
          width: 50px;
        }

        .admin-badge {
          display: none;
        }

        .nav-section-title {
          display: none;
        }

        .nav-item span {
          display: none;
        }

        .nav-item i {
          margin-right: 0;
          font-size: 1.2rem;
        }

        .admin-profile {
          flex-direction: column;
          align-items: center;
          padding: 0.5rem;
        }

        .admin-info {
          display: none;
        }

        .admin-avatar {
          margin-right: 0;
          margin-bottom: 0.5rem;
        }
      }

      @media (max-width: 768px) {
        .header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .header-actions {
          width: 100%;
          justify-content: space-between;
        }

        .dashboard-overview {
          grid-template-columns: 1fr 1fr;
        }

        .search-filter {
          flex-direction: column;
        }
      }

      @media (max-width: 576px) {
        .dashboard-container {
          grid-template-columns: 1fr;
        }

        .sidebar {
          display: none;
        }

        .dashboard-overview {
          grid-template-columns: 1fr;
        }

        .section-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.8rem;
        }

        .section-actions {
          width: 100%;
          justify-content: space-between;
        }

        .tabs {
          overflow-x: auto;
          white-space: nowrap;
          padding-bottom: 0.5rem;
        }

        .tab {
          padding: 0.8rem 1rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="dashboard-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <img
            src="https://axxpoint.imostate.gov.ng/images/imo-state-logo.png"
            alt="IMO State Logo"
            class="sidebar-logo"
          />
          <div class="admin-badge">ADMIN PANEL</div>
        </div>

        <nav class="sidebar-nav">
          <div class="nav-section">
            <div class="nav-section-title">Main</div>
            <a href="#" class="nav-item active" data-section="dashboard">
              <i class="fas fa-tachometer-alt"></i>
              <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-section="complaints">
              <i class="fas fa-bullhorn"></i>
              <span>Complaints</span>
            </a>
            <a href="#" class="nav-item" data-section="users">
              <i class="fas fa-users"></i>
              <span>Users</span>
            </a>
            <a href="#" class="nav-item" data-section="analytics">
              <i class="fas fa-chart-line"></i>
              <span>Analytics</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Management</div>
            <a href="#" class="nav-item" data-section="categories">
              <i class="fas fa-tags"></i>
              <span>Categories</span>
            </a>
            <a href="#" class="nav-item" data-section="lgas">
              <i class="fas fa-map-marker-alt"></i>
              <span>LGAs</span>
            </a>
            <a href="#" class="nav-item" data-section="reports">
              <i class="fas fa-file-alt"></i>
              <span>Reports</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Settings</div>
            <a href="#" class="nav-item" data-section="admins">
              <i class="fas fa-user-shield"></i>
              <span>Admins</span>
            </a>
            <a href="#" class="nav-item" data-section="settings">
              <i class="fas fa-cog"></i>
              <span>Settings</span>
            </a>
          </div>
        </nav>

        <div class="sidebar-footer">
          <div class="admin-profile" id="adminProfileSidebar">
            <div class="admin-avatar">A</div>
            <div class="admin-info">
              <div class="admin-name">Admin User</div>
              <div class="admin-role">Super Admin</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Header -->
        <header class="header">
          <div class="page-title">
            <h1>Admin Dashboard</h1>
            <p>Welcome to the IMO State Citizen Feedback System</p>
          </div>

          <div class="header-actions">
            <button class="notification-btn" id="notificationBtn">
              <i class="fas fa-bell"></i>
              <span class="notification-badge" id="notificationBadge">0</span>
            </button>
            <button class="logout-btn" id="logoutBtn">
              <i class="fas fa-sign-out-alt"></i>
              <span>Logout</span>
            </button>
          </div>
        </header>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="content-section-wrapper">
          <!-- Stats Overview -->
          <div class="dashboard-overview">
            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="totalUsers">0</div>
                  <div class="stat-label">Total Users</div>
                </div>
                <div class="stat-icon users">
                  <i class="fas fa-users"></i>
                </div>
              </div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span id="userGrowth">0%</span> since last month
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="totalComplaints">0</div>
                  <div class="stat-label">Total Complaints</div>
                </div>
                <div class="stat-icon complaints">
                  <i class="fas fa-bullhorn"></i>
                </div>
              </div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span id="complaintGrowth">0%</span> since last month
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="resolvedComplaints">0</div>
                  <div class="stat-label">Resolved</div>
                </div>
                <div class="stat-icon resolved">
                  <i class="fas fa-check-circle"></i>
                </div>
              </div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span id="resolvedGrowth">0%</span> since last month
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <div>
                  <div class="stat-value" id="pendingComplaints">0</div>
                  <div class="stat-label">Pending</div>
                </div>
                <div class="stat-icon pending">
                  <i class="fas fa-clock"></i>
                </div>
              </div>
              <div class="stat-change negative">
                <i class="fas fa-arrow-down"></i>
                <span id="pendingGrowth">0%</span> since last month
              </div>
            </div>
          </div>

          <!-- Recent Complaints -->
          <div class="content-section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-bullhorn"></i> Recent Complaints
              </h3>
              <div class="section-actions">
                <button class="action-btn" id="exportRecentBtn">
                  <i class="fas fa-download"></i> Export
                </button>
                <button class="action-btn primary" id="viewAllComplaintsBtn">
                  <i class="fas fa-eye"></i> View All
                </button>
              </div>
            </div>
            <div class="section-body">
              <div class="table-container">
                <table class="admin-table" id="recentComplaintsTable">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Title</th>
                      <th>User</th>
                      <th>Category</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="recentComplaintsList">
                    <!-- Dynamically populated by JavaScript -->
                    <tr>
                      <td colspan="7">
                        <div class="loading-spinner">
                          <div class="spinner"></div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Recent Users -->
          <div class="content-section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-users"></i> Recent Users
              </h3>
              <div class="section-actions">
                <button class="action-btn" id="exportUsersBtn">
                  <i class="fas fa-download"></i> Export
                </button>
                <button class="action-btn primary" id="viewAllUsersBtn">
                  <i class="fas fa-eye"></i> View All
                </button>
              </div>
            </div>
            <div class="section-body">
              <div class="table-container">
                <table class="admin-table" id="recentUsersTable">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Phone</th>
                      <th>LGA</th>
                      <th>Joined</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="recentUsersList">
                    <!-- Dynamically populated by JavaScript -->
                    <tr>
                      <td colspan="7">
                        <div class="loading-spinner">
                          <div class="spinner"></div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Complaints Section -->
        <div
          id="complaintsSection"
          class="content-section-wrapper"
          style="display: none"
        >
          <div class="content-section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-bullhorn"></i> All Complaints
              </h3>
              <div class="section-actions">
                <button class="action-btn" id="exportAllComplaintsBtn">
                  <i class="fas fa-download"></i> Export
                </button>
                <button class="action-btn primary" id="bulkActionBtn">
                  <i class="fas fa-cogs"></i> Bulk Actions
                </button>
              </div>
            </div>

            <div class="tabs">
              <div class="tab active" data-tab="all">All</div>
              <div class="tab" data-tab="pending">Pending</div>
              <div class="tab" data-tab="resolved">Resolved</div>
              <div class="tab" data-tab="new">New</div>
            </div>

            <div class="section-body">
              <div class="search-filter">
                <div class="search-box">
                  <i class="fas fa-search search-icon"></i>
                  <input
                    type="text"
                    class="search-input"
                    id="complaintSearch"
                    placeholder="Search complaints..."
                  />
                </div>
                <div class="filter-dropdown">
                  <button class="filter-btn">
                    <i class="fas fa-filter"></i>
                    <span>Filter</span>
                  </button>
                  <div class="filter-dropdown-content">
                    <div class="filter-option" data-filter="all">
                      All Categories
                    </div>
                    <div
                      class="filter-option"
                      data-filter="Roads & Transportation"
                    >
                      Roads & Transportation
                    </div>
                    <div class="filter-option" data-filter="Public Health">
                      Public Health
                    </div>
                    <div class="filter-option" data-filter="Education">
                      Education
                    </div>
                    <div class="filter-option" data-filter="Security">
                      Security
                    </div>
                    <div class="filter-option" data-filter="Water Supply">
                      Water Supply
                    </div>
                    <div class="filter-option" data-filter="Electricity">
                      Electricity
                    </div>
                    <div class="filter-option" data-filter="Waste Management">
                      Waste Management
                    </div>
                    <div class="filter-option" data-filter="Other">Other</div>
                  </div>
                </div>
              </div>

              <div class="table-container">
                <table class="admin-table" id="complaintsTable">
                  <thead>
                    <tr>
                      <th>
                        <input type="checkbox" id="selectAllComplaints" />
                      </th>
                      <th>ID</th>
                      <th>Title</th>
                      <th>User</th>
                      <th>Category</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="complaintsList">
                    <!-- Dynamically populated by JavaScript -->
                    <tr>
                      <td colspan="8">
                        <div class="loading-spinner">
                          <div class="spinner"></div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="pagination" id="complaintsPagination">
                <!-- Dynamically populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <!-- Users Section -->
        <div
          id="usersSection"
          class="content-section-wrapper"
          style="display: none"
        >
          <div class="content-section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-users"></i> All Users
              </h3>
              <div class="section-actions">
                <button class="action-btn" id="exportAllUsersBtn">
                  <i class="fas fa-download"></i> Export
                </button>
                <button class="action-btn primary" id="addUserBtn">
                  <i class="fas fa-user-plus"></i> Add User
                </button>
              </div>
            </div>

            <div class="tabs">
              <div class="tab active" data-tab="all-users">All</div>
              <div class="tab" data-tab="active-users">Active</div>
              <div class="tab" data-tab="inactive-users">Inactive</div>
            </div>

            <div class="section-body">
              <div class="search-filter">
                <div class="search-box">
                  <i class="fas fa-search search-icon"></i>
                  <input
                    type="text"
                    class="search-input"
                    id="userSearch"
                    placeholder="Search users..."
                  />
                </div>
                <div class="filter-dropdown">
                  <button class="filter-btn">
                    <i class="fas fa-filter"></i>
                    <span>Filter by LGA</span>
                  </button>
                  <div class="filter-dropdown-content" id="lgaFilterOptions">
                    <!-- Dynamically populated by JavaScript -->
                    <div class="filter-option" data-filter="all">All LGAs</div>
                  </div>
                </div>
              </div>

              <div class="table-container">
                <table class="admin-table" id="usersTable">
                  <thead>
                    <tr>
                      <th><input type="checkbox" id="selectAllUsers" /></th>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Phone</th>
                      <th>LGA</th>
                      <th>Complaints</th>
                      <th>Joined</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="usersList">
                    <!-- Dynamically populated by JavaScript -->
                    <tr>
                      <td colspan="9">
                        <div class="loading-spinner">
                          <div class="spinner"></div>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="pagination" id="usersPagination">
                <!-- Dynamically populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <!-- Analytics Section -->
        <div
          id="analyticsSection"
          class="content-section-wrapper"
          style="display: none"
        >
          <div class="content-section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-chart-line"></i> Analytics Overview
              </h3>
              <div class="section-actions">
                <button class="action-btn" id="exportAnalyticsBtn">
                  <i class="fas fa-download"></i> Export
                </button>
                <div class="filter-dropdown">
                  <button class="filter-btn">
                    <i class="fas fa-calendar"></i>
                    <span>This Month</span>
                  </button>
                  <div class="filter-dropdown-content">
                    <div class="filter-option" data-period="week">
                      This Week
                    </div>
                    <div class="filter-option" data-period="month">
                      This Month
                    </div>
                    <div class="filter-option" data-period="quarter">
                      This Quarter
                    </div>
                    <div class="filter-option" data-period="year">
                      This Year
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="section-body">
              <div class="dashboard-overview">
                <div class="stat-card">
                  <div class="stat-header">
                    <div>
                      <div class="stat-value" id="newUsersAnalytics">0</div>
                      <div class="stat-label">New Users</div>
                    </div>
                    <div class="stat-icon users">
                      <i class="fas fa-user-plus"></i>
                    </div>
                  </div>
                </div>

                <div class="stat-card">
                  <div class="stat-header">
                    <div>
                      <div class="stat-value" id="newComplaintsAnalytics">
                        0
                      </div>
                      <div class="stat-label">New Complaints</div>
                    </div>
                    <div class="stat-icon complaints">
                      <i class="fas fa-bullhorn"></i>
                    </div>
                  </div>
                </div>

                <div class="stat-card">
                  <div class="stat-header">
                    <div>
                      <div class="stat-value" id="resolutionRateAnalytics">
                        0%
                      </div>
                      <div class="stat-label">Resolution Rate</div>
                    </div>
                    <div class="stat-icon resolved">
                      <i class="fas fa-check-double"></i>
                    </div>
                  </div>
                </div>

                <div class="stat-card">
                  <div class="stat-header">
                    <div>
                      <div class="stat-value" id="avgResponseTimeAnalytics">
                        0h
                      </div>
                      <div class="stat-label">Avg. Response Time</div>
                    </div>
                    <div class="stat-icon pending">
                      <i class="fas fa-hourglass-half"></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Charts -->
              <div class="content-section">
                <div class="section-header">
                  <h3 class="section-title">Complaints Trend</h3>
                </div>
                <div class="section-body">
                  <div class="chart-container" id="complaintsChart">
                    <!-- Chart will be rendered here -->
                    <div class="loading-spinner">
                      <div class="spinner"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="content-section">
                <div class="section-header">
                  <h3 class="section-title">Complaints by Category</h3>
                </div>
                <div class="section-body">
                  <div class="chart-container" id="categoriesChart">
                    <!-- Chart will be rendered here -->
                    <div class="loading-spinner">
                      <div class="spinner"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="content-section">
                <div class="section-header">
                  <h3 class="section-title">Complaints by LGA</h3>
                </div>
                <div class="section-body">
                  <div class="chart-container" id="lgaChart">
                    <!-- Chart will be rendered here -->
                    <div class="loading-spinner">
                      <div class="spinner"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- View Complaint Modal -->
    <div class="modal-overlay" id="viewComplaintModal">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title">Complaint Details</h3>
          <button class="modal-close" id="closeViewComplaintModal">
            &times;
          </button>
        </div>
        <div class="modal-body" id="complaintDetails">
          <!-- Dynamically populated by JavaScript -->
          <div class="loading-spinner">
            <div class="spinner"></div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn cancel" id="closeComplaintBtn">Close</button>
          <button class="modal-btn submit" id="updateStatusBtn">
            Update Status
          </button>
        </div>
      </div>
    </div>

    <!-- Update Status Modal -->
    <div class="modal-overlay" id="updateStatusModal">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title">Update Complaint Status</h3>
          <button class="modal-close" id="closeUpdateStatusModal">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="complaintStatus" class="form-label">Status</label>
            <div class="select-wrapper">
              <select id="complaintStatus" class="form-control">
                <option value="Pending">Pending</option>
                <option value="In Progress">In Progress</option>
                <option value="Resolved">Resolved</option>
                <option value="Rejected">Rejected</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="statusComment" class="form-label">Comment</label>
            <textarea
              id="statusComment"
              class="form-control"
              placeholder="Add a comment about this status update..."
            ></textarea>
          </div>
        </div>
        <div class="modal-footer">
          <button class="modal-btn cancel" id="cancelStatusUpdate">
            Cancel
          </button>
          <button class="modal-btn submit" id="saveStatusUpdate">
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- Add/Edit User Modal -->
    <div class="modal-overlay" id="userModal">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title" id="userModalTitle">Add New User</h3>
          <button class="modal-close" id="closeUserModal">&times;</button>
        </div>
        <div class="modal-body">
          <form id="userForm">
            <div class="form-group">
              <label for="userName" class="form-label">Full Name</label>
              <input
                type="text"
                id="userName"
                class="form-control"
                placeholder="Enter full name"
                required
              />
            </div>
            <div class="form-group">
              <label for="userPhone" class="form-label">Phone Number</label>
              <input
                type="tel"
                id="userPhone"
                class="form-control"
                placeholder="Enter phone number"
                required
              />
            </div>
            <div class="form-group">
              <label for="userLGA" class="form-label">Local Government</label>
              <div class="select-wrapper">
                <select id="userLGA" class="form-control" required>
                  <option value="" disabled selected>Select LGA</option>
                  <option value="Aboh Mbaise">Aboh Mbaise</option>
                  <option value="Ahiazu Mbaise">Ahiazu Mbaise</option>
                  <option value="Ehime Mbano">Ehime Mbano</option>
                  <option value="Ezinihitte">Ezinihitte</option>
                  <option value="Ideato North">Ideato North</option>
                  <option value="Ideato South">Ideato South</option>
                  <option value="Ihitte/Uboma">Ihitte/Uboma</option>
                  <option value="Ikeduru">Ikeduru</option>
                  <option value="Isiala Mbano">Isiala Mbano</option>
                  <option value="Isu">Isu</option>
                  <option value="Mbaitoli">Mbaitoli</option>
                  <option value="Ngor Okpala">Ngor Okpala</option>
                  <option value="Njaba">Njaba</option>
                  <option value="Nkwerre">Nkwerre</option>
                  <option value="Nwangele">Nwangele</option>
                  <option value="Obowo">Obowo</option>
                  <option value="Oguta">Oguta</option>
                  <option value="Ohaji/Egbema">Ohaji/Egbema</option>
                  <option value="Okigwe">Okigwe</option>
                  <option value="Onuimo">Onuimo</option>
                  <option value="Orlu">Orlu</option>
                  <option value="Orsu">Orsu</option>
                  <option value="Oru East">Oru East</option>
                  <option value="Oru West">Oru West</option>
                  <option value="Owerri Municipal">Owerri Municipal</option>
                  <option value="Owerri North">Owerri North</option>
                  <option value="Owerri West">Owerri West</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="userAddress" class="form-label">Address</label>
              <input
                type="text"
                id="userAddress"
                class="form-control"
                placeholder="Enter address"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label">Gender</label>
              <div style="display: flex; gap: 20px">
                <div style="display: flex; align-items: center">
                  <input
                    type="radio"
                    id="userGenderMale"
                    name="userGender"
                    value="male"
                    required
                  />
                  <label for="userGenderMale" style="margin-left: 8px"
                    >Male</label
                  >
                </div>
                <div style="display: flex; align-items: center">
                  <input
                    type="radio"
                    id="userGenderFemale"
                    name="userGender"
                    value="female"
                  />
                  <label for="userGenderFemale" style="margin-left: 8px"
                    >Female</label
                  >
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="userPassword" class="form-label">Password</label>
              <input
                type="password"
                id="userPassword"
                class="form-control"
                placeholder="Enter password"
                required
              />
            </div>
            <div class="form-group">
              <label for="userStatus" class="form-label">Status</label>
              <div class="select-wrapper">
                <select id="userStatus" class="form-control">
                  <option value="active">Active</option>
                  <option value="inactive">Inactive</option>
                </select>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="modal-btn cancel" id="cancelUser">Cancel</button>
          <button class="modal-btn submit" id="saveUser">Save User</button>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteConfirmModal">
      <div class="modal">
        <div class="modal-header">
          <h3 class="modal-title">Confirm Deletion</h3>
          <button class="modal-close" id="closeDeleteConfirmModal">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <p>
            Are you sure you want to delete this item? This action cannot be
            undone.
          </p>
        </div>
        <div class="modal-footer">
          <button class="modal-btn cancel" id="cancelDelete">Cancel</button>
          <button class="modal-btn delete" id="confirmDelete">Delete</button>
        </div>
      </div>
    </div>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCgOvIkDCcS3DFrt5f6Y7pYmjCoHIfDF9U",
        authDomain: "moniebase-b4b4d.firebaseapp.com",
        projectId: "moniebase-b4b4d",
        storageBucket: "moniebase-b4b4d.appspot.com",
        messagingSenderId: "1009678808253",
        appId: "1:1009678808253:android:ff94e94c52bad2db7973d4",
        databaseURL: "https://moniebase-b4b4d-default-rtdb.firebaseio.com/",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const database = firebase.database();
      const storage = firebase.storage();

      // DOM Elements - Navigation
      const navItems = document.querySelectorAll(".nav-item");
      const contentSections = document.querySelectorAll(
        ".content-section-wrapper"
      );
      const logoutBtn = document.getElementById("logoutBtn");
      const adminProfileSidebar = document.getElementById(
        "adminProfileSidebar"
      );

      // DOM Elements - Dashboard
      const totalUsers = document.getElementById("totalUsers");
      const totalComplaints = document.getElementById("totalComplaints");
      const resolvedComplaints = document.getElementById("resolvedComplaints");
      const pendingComplaints = document.getElementById("pendingComplaints");
      const userGrowth = document.getElementById("userGrowth");
      const complaintGrowth = document.getElementById("complaintGrowth");
      const resolvedGrowth = document.getElementById("resolvedGrowth");
      const pendingGrowth = document.getElementById("pendingGrowth");
      const recentComplaintsList = document.getElementById(
        "recentComplaintsList"
      );
      const recentUsersList = document.getElementById("recentUsersList");

      // DOM Elements - Complaints
      const complaintsList = document.getElementById("complaintsList");
      const complaintsPagination = document.getElementById(
        "complaintsPagination"
      );
      const complaintSearch = document.getElementById("complaintSearch");
      const complaintTabs = document.querySelectorAll(".tab[data-tab]");
      const viewComplaintModal = document.getElementById("viewComplaintModal");
      const closeViewComplaintModal = document.getElementById(
        "closeViewComplaintModal"
      );
      const closeComplaintBtn = document.getElementById("closeComplaintBtn");
      const complaintDetails = document.getElementById("complaintDetails");
      const updateStatusBtn = document.getElementById("updateStatusBtn");
      const updateStatusModal = document.getElementById("updateStatusModal");
      const closeUpdateStatusModal = document.getElementById(
        "closeUpdateStatusModal"
      );
      const cancelStatusUpdate = document.getElementById("cancelStatusUpdate");
      const saveStatusUpdate = document.getElementById("saveStatusUpdate");
      const complaintStatus = document.getElementById("complaintStatus");
      const statusComment = document.getElementById("statusComment");

      // DOM Elements - Users
      const usersList = document.getElementById("usersList");
      const usersPagination = document.getElementById("usersPagination");
      const userSearch = document.getElementById("userSearch");
      const userTabs = document.querySelectorAll('.tab[data-tab*="users"]');
      const addUserBtn = document.getElementById("addUserBtn");
      const userModal = document.getElementById("userModal");
      const closeUserModal = document.getElementById("closeUserModal");
      const cancelUser = document.getElementById("cancelUser");
      const saveUser = document.getElementById("saveUser");
      const userForm = document.getElementById("userForm");
      const userModalTitle = document.getElementById("userModalTitle");

      // DOM Elements - Delete Confirmation
      const deleteConfirmModal = document.getElementById("deleteConfirmModal");
      const closeDeleteConfirmModal = document.getElementById(
        "closeDeleteConfirmModal"
      );
      const cancelDelete = document.getElementById("cancelDelete");
      const confirmDelete = document.getElementById("confirmDelete");

      // Global Variables
      let currentUser = null;
      let currentSection = "dashboard";
      let currentComplaintsTab = "all";
      let currentUsersTab = "all-users";
      let currentPage = 1;
      let itemsPerPage = 10;
      let allComplaints = [];
      let filteredComplaints = [];
      let allUsers = [];
      let filteredUsers = [];
      let selectedItemId = null;
      let selectedItemType = null;
      let isEditingUser = false;

      // Initialize the application
      function initApp() {
        auth.onAuthStateChanged((user) => {
          if (user) {
            currentUser = user;
            checkAdminStatus();
          } else {
            window.location.href = "auth.html";
          }
        });
      }

      // Check if the current user is an admin
      function checkAdminStatus() {
        database
          .ref("admins/" + currentUser.uid)
          .once("value")
          .then((snapshot) => {
            if (snapshot.exists()) {
              // User is an admin
              loadAdminData(snapshot.val());
              initializeDashboard();
            } else {
              // User is not an admin, redirect to citizen dashboard
              alert("You don't have admin privileges.");
              window.location.href = "dashboard.html";
            }
          })
          .catch((error) => {
            console.error("Error checking admin status:", error);
            alert("An error occurred. Please try again later.");
          });
      }

      // Load admin data
      function loadAdminData(adminData) {
        const initials = adminData.name
          .split(" ")
          .map((name) => name[0])
          .join("")
          .toUpperCase();

        adminProfileSidebar.innerHTML = `
          <div class="admin-avatar">${initials}</div>
          <div class="admin-info">
            <div class="admin-name">${adminData.name}</div>
            <div class="admin-role">${adminData.role || "Admin"}</div>
          </div>
        `;
      }

      // Initialize dashboard
      function initializeDashboard() {
        loadStats();
        loadRecentComplaints();
        loadRecentUsers();
        setupEventListeners();
      }

      // Load statistics for dashboard
      function loadStats() {
        // Load user stats
        database
          .ref("users")
          .once("value")
          .then((snapshot) => {
            const users = snapshot.val() || {};
            const userCount = Object.keys(users).length;
            totalUsers.textContent = userCount;

            // Calculate user growth (mock data for demo)
            userGrowth.textContent = "12%";

            // Count complaints by status
            return database.ref("complaints").once("value");
          })
          .then((snapshot) => {
            const complaints = snapshot.val() || {};
            const complaintIds = Object.keys(complaints);
            const complaintCount = complaintIds.length;

            let resolvedCount = 0;
            let pendingCount = 0;

            complaintIds.forEach((id) => {
              const complaint = complaints[id];
              if (complaint.status === "Resolved") {
                resolvedCount++;
              } else if (complaint.status === "Pending") {
                pendingCount++;
              }
            });

            totalComplaints.textContent = complaintCount;
            resolvedComplaints.textContent = resolvedCount;
            pendingComplaints.textContent = pendingCount;

            // Calculate growth rates (mock data for demo)
            complaintGrowth.textContent = "8%";
            resolvedGrowth.textContent = "15%";
            pendingGrowth.textContent = "5%";
          })
          .catch((error) => {
            console.error("Error loading stats:", error);
          });
      }

      // Load recent complaints for dashboard
      function loadRecentComplaints() {
        database
          .ref("complaints")
          .orderByChild("timestamp")
          .limitToLast(5)
          .once("value")
          .then((snapshot) => {
            const complaints = [];
            snapshot.forEach((childSnapshot) => {
              const complaint = childSnapshot.val();
              complaint.id = childSnapshot.key;
              complaints.unshift(complaint); // Newest first
            });

            renderRecentComplaints(complaints);
          })
          .catch((error) => {
            console.error("Error loading recent complaints:", error);
          });
      }

      // Render recent complaints
      function renderRecentComplaints(complaints) {
        if (complaints.length === 0) {
          recentComplaintsList.innerHTML = `
            <tr>
              <td colspan="7" style="text-align: center; padding: 1.5rem;">No complaints found</td>
            </tr>
          `;
          return;
        }

        recentComplaintsList.innerHTML = complaints
          .map((complaint) => {
            const date = new Date(complaint.timestamp);
            const formattedDate = date.toLocaleDateString("en-US", {
              month: "short",
              day: "numeric",
              year: "numeric",
            });

            const statusClass =
              complaint.status === "Pending"
                ? "status-pending"
                : complaint.status === "Resolved"
                ? "status-resolved"
                : "status-new";

            return `
            <tr>
              <td>${complaint.id.substring(0, 8)}...</td>
              <td>${complaint.title}</td>
              <td>${complaint.userName}</td>
              <td>${complaint.category}</td>
              <td>${formattedDate}</td>
              <td><span class="status-badge ${statusClass}">${
              complaint.status
            }</span></td>
              <td>
                <div class="table-actions">
                  <button class="table-action-btn view" onclick="viewComplaint('${
                    complaint.id
                  }')">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="table-action-btn edit" onclick="editComplaintStatus('${
                    complaint.id
                  }')">
                    <i class="fas fa-edit"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          })
          .join("");
      }

      // Load recent users for dashboard
      function loadRecentUsers() {
        database
          .ref("users")
          .orderByChild("createdAt")
          .limitToLast(5)
          .once("value")
          .then((snapshot) => {
            const users = [];
            snapshot.forEach((childSnapshot) => {
              const user = childSnapshot.val();
              user.id = childSnapshot.key;
              users.unshift(user); // Newest first
            });

            renderRecentUsers(users);
          })
          .catch((error) => {
            console.error("Error loading recent users:", error);
          });
      }

      // Render recent users
      function renderRecentUsers(users) {
        if (users.length === 0) {
          recentUsersList.innerHTML = `
            <tr>
              <td colspan="7" style="text-align: center; padding: 1.5rem;">No users found</td>
            </tr>
          `;
          return;
        }

        recentUsersList.innerHTML = users
          .map((user) => {
            const date = new Date(user.createdAt);
            const formattedDate = date.toLocaleDateString("en-US", {
              month: "short",
              day: "numeric",
              year: "numeric",
            });

            const status = user.status || "active";
            const statusClass =
              status === "active" ? "status-active" : "status-inactive";

            return `
            <tr>
              <td>${user.id.substring(0, 8)}...</td>
              <td>${user.fullName}</td>
              <td>${user.phoneNumber}</td>
              <td>${user.localGovernment}</td>
              <td>${formattedDate}</td>
              <td><span class="status-badge ${statusClass}">${
              status.charAt(0).toUpperCase() + status.slice(1)
            }</span></td>
              <td>
                <div class="table-actions">
                  <button class="table-action-btn view" onclick="viewUser('${
                    user.id
                  }')">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="table-action-btn edit" onclick="editUser('${
                    user.id
                  }')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="table-action-btn delete" onclick="deleteUser('${
                    user.id
                  }')">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          })
          .join("");
      }

      // Load all complaints
      function loadAllComplaints() {
        database
          .ref("complaints")
          .orderByChild("timestamp")
          .once("value")
          .then((snapshot) => {
            allComplaints = [];
            snapshot.forEach((childSnapshot) => {
              const complaint = childSnapshot.val();
              complaint.id = childSnapshot.key;
              allComplaints.unshift(complaint); // Newest first
            });

            filterComplaints(currentComplaintsTab);
          })
          .catch((error) => {
            console.error("Error loading all complaints:", error);
          });
      }

      // Filter complaints based on tab and search
      function filterComplaints(tab) {
        currentComplaintsTab = tab;
        const searchTerm = complaintSearch.value.toLowerCase();

        filteredComplaints = allComplaints.filter((complaint) => {
          // Filter by tab
          if (tab !== "all" && complaint.status.toLowerCase() !== tab) {
            return false;
          }

          // Filter by search term
          if (searchTerm) {
            return (
              complaint.title.toLowerCase().includes(searchTerm) ||
              complaint.description.toLowerCase().includes(searchTerm) ||
              complaint.userName.toLowerCase().includes(searchTerm) ||
              complaint.category.toLowerCase().includes(searchTerm)
            );
          }

          return true;
        });

        renderComplaints();
      }

      // Render complaints with pagination
      function renderComplaints() {
        if (filteredComplaints.length === 0) {
          complaintsList.innerHTML = `
            <tr>
              <td colspan="8" style="text-align: center; padding: 1.5rem;">No complaints found</td>
            </tr>
          `;
          complaintsPagination.innerHTML = "";
          return;
        }

        // Calculate pagination
        const totalPages = Math.ceil(filteredComplaints.length / itemsPerPage);
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = Math.min(
          startIndex + itemsPerPage,
          filteredComplaints.length
        );
        const currentPageComplaints = filteredComplaints.slice(
          startIndex,
          endIndex
        );

        // Render complaints
        complaintsList.innerHTML = currentPageComplaints
          .map((complaint) => {
            const date = new Date(complaint.timestamp);
            const formattedDate = date.toLocaleDateString("en-US", {
              month: "short",
              day: "numeric",
              year: "numeric",
            });

            const statusClass =
              complaint.status === "Pending"
                ? "status-pending"
                : complaint.status === "Resolved"
                ? "status-resolved"
                : "status-new";

            return `
            <tr>
              <td><input type="checkbox" class="complaint-checkbox" data-id="${
                complaint.id
              }"></td>
              <td>${complaint.id.substring(0, 8)}...</td>
              <td>${complaint.title}</td>
              <td>${complaint.userName}</td>
              <td>${complaint.category}</td>
              <td>${formattedDate}</td>
              <td><span class="status-badge ${statusClass}">${
              complaint.status
            }</span></td>
              <td>
                <div class="table-actions">
                  <button class="table-action-btn view" onclick="viewComplaint('${
                    complaint.id
                  }')">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="table-action-btn edit" onclick="editComplaintStatus('${
                    complaint.id
                  }')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="table-action-btn delete" onclick="deleteComplaint('${
                    complaint.id
                  }')">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          })
          .join("");

        // Render pagination
        renderPagination(totalPages, complaintsPagination);
      }

      // Load all users
      function loadAllUsers() {
        database
          .ref("users")
          .orderByChild("createdAt")
          .once("value")
          .then((snapshot) => {
            allUsers = [];
            snapshot.forEach((childSnapshot) => {
              const user = childSnapshot.val();
              user.id = childSnapshot.key;
              allUsers.unshift(user); // Newest first
            });

            filterUsers(currentUsersTab);
          })
          .catch((error) => {
            console.error("Error loading all users:", error);
          });
      }

      // Filter users based on tab and search
      function filterUsers(tab) {
        currentUsersTab = tab;
        const searchTerm = userSearch.value.toLowerCase();

        filteredUsers = allUsers.filter((user) => {
          // Filter by tab
          if (tab === "active-users" && user.status !== "active") {
            return false;
          }
          if (tab === "inactive-users" && user.status !== "inactive") {
            return false;
          }

          // Filter by search term
          if (searchTerm) {
            return (
              user.fullName.toLowerCase().includes(searchTerm) ||
              user.phoneNumber.includes(searchTerm) ||
              user.localGovernment.toLowerCase().includes(searchTerm)
            );
          }

          return true;
        });

        renderUsers();
      }

      // Render users with pagination
      function renderUsers() {
        if (filteredUsers.length === 0) {
          usersList.innerHTML = `
            <tr>
              <td colspan="9" style="text-align: center; padding: 1.5rem;">No users found</td>
            </tr>
          `;
          usersPagination.innerHTML = "";
          return;
        }

        // Calculate pagination
        const totalPages = Math.ceil(filteredUsers.length / itemsPerPage);
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = Math.min(
          startIndex + itemsPerPage,
          filteredUsers.length
        );
        const currentPageUsers = filteredUsers.slice(startIndex, endIndex);

        // Render users
        usersList.innerHTML = currentPageUsers
          .map((user) => {
            const date = new Date(user.createdAt);
            const formattedDate = date.toLocaleDateString("en-US", {
              month: "short",
              day: "numeric",
              year: "numeric",
            });

            const status = user.status || "active";
            const statusClass =
              status === "active" ? "status-active" : "status-inactive";

            return `
            <tr>
              <td><input type="checkbox" class="user-checkbox" data-id="${
                user.id
              }"></td>
              <td>${user.id.substring(0, 8)}...</td>
              <td>${user.fullName}</td>
              <td>${user.phoneNumber}</td>
              <td>${user.localGovernment}</td>
              <td>${user.complaintCount || 0}</td>
              <td>${formattedDate}</td>
              <td><span class="status-badge ${statusClass}">${
              status.charAt(0).toUpperCase() + status.slice(1)
            }</span></td>
              <td>
                <div class="table-actions">
                  <button class="table-action-btn view" onclick="viewUser('${
                    user.id
                  }')">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="table-action-btn edit" onclick="editUser('${
                    user.id
                  }')">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="table-action-btn delete" onclick="deleteUser('${
                    user.id
                  }')">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          `;
          })
          .join("");

        // Render pagination
        renderPagination(totalPages, usersPagination);
      }

      // Render pagination controls
      function renderPagination(totalPages, paginationElement) {
        if (totalPages <= 1) {
          paginationElement.innerHTML = "";
          return;
        }

        let paginationHTML = `
          <div class="page-item ${
            currentPage === 1 ? "disabled" : ""
          }" onclick="changePage(${currentPage - 1})">
            <i class="fas fa-chevron-left"></i>
          </div>
        `;

        for (let i = 1; i <= totalPages; i++) {
          if (
            i === 1 ||
            i === totalPages ||
            (i >= currentPage - 1 && i <= currentPage + 1)
          ) {
            paginationHTML += `
              <div class="page-item ${
                i === currentPage ? "active" : ""
              }" onclick="changePage(${i})">
                ${i}
              </div>
            `;
          } else if (i === currentPage - 2 || i === currentPage + 2) {
            paginationHTML += `<div class="page-item">...</div>`;
          }
        }

        paginationHTML += `
          <div class="page-item ${
            currentPage === totalPages ? "disabled" : ""
          }" onclick="changePage(${currentPage + 1})">
            <i class="fas fa-chevron-right"></i>
          </div>
        `;

        paginationElement.innerHTML = paginationHTML;
      }

      // Change page
      function changePage(page) {
        if (
          page < 1 ||
          page > Math.ceil(filteredComplaints.length / itemsPerPage)
        ) {
          return;
        }

        currentPage = page;

        if (currentSection === "complaints") {
          renderComplaints();
        } else if (currentSection === "users") {
          renderUsers();
        }
      }

      // View complaint details
      function viewComplaint(complaintId) {
        database
          .ref("complaints/" + complaintId)
          .once("value")
          .then((snapshot) => {
            const complaint = snapshot.val();
            complaint.id = snapshot.key;

            renderComplaintDetails(complaint);
            viewComplaintModal.classList.add("active");
            selectedItemId = complaintId;
          })
          .catch((error) => {
            console.error("Error loading complaint details:", error);
          });
      }

      // Render complaint details in modal
      function renderComplaintDetails(complaint) {
        const date = new Date(complaint.timestamp);
        const formattedDate = date.toLocaleDateString("en-US", {
          month: "long",
          day: "numeric",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });

        const statusClass =
          complaint.status === "Pending"
            ? "status-pending"
            : complaint.status === "Resolved"
            ? "status-resolved"
            : "status-new";

        let repliesHTML = "";
        if (complaint.replies) {
          repliesHTML = `
            <div style="margin-top: 1.5rem; border-top: 1px solid var(--gray-light); padding-top: 1.5rem;">
              <h4 style="margin-bottom: 1rem;">Replies</h4>
              <div style="display: flex; flex-direction: column; gap: 1rem;">
          `;

          Object.values(complaint.replies).forEach((reply) => {
            const replyDate = new Date(reply.timestamp);
            const formattedReplyDate = replyDate.toLocaleDateString("en-US", {
              month: "short",
              day: "numeric",
              year: "numeric",
              hour: "2-digit",
              minute: "2-digit",
            });

            repliesHTML += `
              <div style="background-color: var(--light-color); padding: 1rem; border-radius: var(--border-radius);">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                  <strong>${reply.userName} (${
              reply.userRole || "User"
            })</strong>
                  <span style="color: var(--gray-medium); font-size: 0.85rem;">${formattedReplyDate}</span>
                </div>
                <p>${reply.content}</p>
              </div>
            `;
          });

          repliesHTML += `
              </div>
            </div>
          `;
        }

        complaintDetails.innerHTML = `
          <div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
              <span class="status-badge ${statusClass}" style="font-size: 0.9rem;">${
          complaint.status
        }</span>
              <span style="color: var(--gray-medium); font-size: 0.9rem;">${formattedDate}</span>
            </div>
            
            <h3 style="margin-bottom: 0.5rem;">${complaint.title}</h3>
            <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
              <span style="background-color: var(--primary-light); color: var(--primary-color); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem;">${
                complaint.category
              }</span>
              <span style="color: var(--gray-medium); font-size: 0.85rem;">Location: ${
                complaint.location
              }</span>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
              <p style="margin-bottom: 1rem;">${complaint.description}</p>
              ${
                complaint.imageUrl
                  ? `<img src="${complaint.imageUrl}" alt="Complaint Image" style="max-width: 100%; border-radius: var(--border-radius); margin-top: 1rem;">`
                  : ""
              }
            </div>
            
            <div style="background-color: var(--light-color); padding: 1rem; border-radius: var(--border-radius); margin-bottom: 1.5rem;">
              <h4 style="margin-bottom: 0.5rem;">Submitted By</h4>
              <div style="display: flex; gap: 2rem;">
                <div>
                  <strong>Name:</strong> ${complaint.userName}
                </div>
                <div>
                  <strong>LGA:</strong> ${complaint.userLGA}
                </div>
              </div>
            </div>
            
            ${repliesHTML}
            
            <div style="margin-top: 1.5rem; border-top: 1px solid var(--gray-light); padding-top: 1.5rem;">
              <h4 style="margin-bottom: 1rem;">Add Admin Reply</h4>
              <textarea class="form-control" id="adminReply" placeholder="Type your reply here..." style="margin-bottom: 1rem;"></textarea>
              <button class="action-btn primary" id="submitReplyBtn" onclick="submitAdminReply('${
                complaint.id
              }')">
                <i class="fas fa-paper-plane"></i> Send Reply
              </button>
            </div>
          </div>
        `;
      }

      // Submit admin reply to complaint
      function submitAdminReply(complaintId) {
        const replyContent = document.getElementById("adminReply").value.trim();
        if (!replyContent) return;

        const reply = {
          userId: currentUser.uid,
          userName: "Admin",
          userRole: "Administrator",
          content: replyContent,
          timestamp: Date.now(),
        };

        // Get a reference to the replies
        const replyRef = database
          .ref(`complaints/${complaintId}/replies`)
          .push();

        // Update reply count
        database
          .ref(`complaints/${complaintId}/replyCount`)
          .transaction((count) => {
            return (count || 0) + 1;
          });

        // Save the reply
        replyRef
          .set(reply)
          .then(() => {
            // Refresh the complaint details
            viewComplaint(complaintId);
            document.getElementById("adminReply").value = "";
          })
          .catch((error) => {
            console.error("Error submitting reply:", error);
          });
      }

      // Edit complaint status
      function editComplaintStatus(complaintId) {
        selectedItemId = complaintId;

        database
          .ref("complaints/" + complaintId)
          .once("value")
          .then((snapshot) => {
            const complaint = snapshot.val();

            // Set current status in dropdown
            complaintStatus.value = complaint.status;
            statusComment.value = "";

            // Show update status modal
            updateStatusModal.classList.add("active");
          })
          .catch((error) => {
            console.error("Error loading complaint status:", error);
          });
      }

      // Save updated complaint status
      function saveComplaintStatusUpdate() {
        const newStatus = complaintStatus.value;
        const comment = statusComment.value.trim();

        if (!selectedItemId) return;

        // Update complaint status
        database
          .ref(`complaints/${selectedItemId}`)
          .update({
            status: newStatus,
            lastUpdated: Date.now(),
          })
          .then(() => {
            // Add admin comment if provided
            if (comment) {
              return submitAdminReply(selectedItemId);
            }
          })
          .then(() => {
            // Close modal and refresh data
            updateStatusModal.classList.remove("active");

            if (currentSection === "dashboard") {
              loadRecentComplaints();
              loadStats();
            } else if (currentSection === "complaints") {
              loadAllComplaints();
            }
          })
          .catch((error) => {
            console.error("Error updating complaint status:", error);
          });
      }

      // Delete complaint
      function deleteComplaint(complaintId) {
        selectedItemId = complaintId;
        selectedItemType = "complaint";

        // Show delete confirmation modal
        deleteConfirmModal.classList.add("active");
      }

      // Confirm delete item
      function confirmDeleteItem() {
        if (!selectedItemId || !selectedItemType) return;

        if (selectedItemType === "complaint") {
          // Delete complaint
          database
            .ref(`complaints/${selectedItemId}`)
            .remove()
            .then(() => {
              deleteConfirmModal.classList.remove("active");

              if (currentSection === "dashboard") {
                loadRecentComplaints();
                loadStats();
              } else if (currentSection === "complaints") {
                loadAllComplaints();
              }
            })
            .catch((error) => {
              console.error("Error deleting complaint:", error);
            });
        } else if (selectedItemType === "user") {
          // Delete user
          database
            .ref(`users/${selectedItemId}`)
            .remove()
            .then(() => {
              deleteConfirmModal.classList.remove("active");

              if (currentSection === "dashboard") {
                loadRecentUsers();
                loadStats();
              } else if (currentSection === "users") {
                loadAllUsers();
              }
            })
            .catch((error) => {
              console.error("Error deleting user:", error);
            });
        }
      }

      // View user details
      function viewUser(userId) {
        // Implement user details view
        console.log("View user:", userId);
      }

      // Edit user
      function editUser(userId) {
        isEditingUser = true;
        selectedItemId = userId;
        userModalTitle.textContent = "Edit User";

        database
          .ref("users/" + userId)
          .once("value")
          .then((snapshot) => {
            const user = snapshot.val();

            // Populate form fields
            document.getElementById("userName").value = user.fullName;
            document.getElementById("userPhone").value = user.phoneNumber;
            document.getElementById("userLGA").value = user.localGovernment;
            document.getElementById("userAddress").value = user.address;

            if (user.gender === "male") {
              document.getElementById("userGenderMale").checked = true;
            } else {
              document.getElementById("userGenderFemale").checked = true;
            }

            document.getElementById("userPassword").value = "";
            document.getElementById("userPassword").placeholder =
              "Leave blank to keep current password";
            document.getElementById("userPassword").required = false;

            document.getElementById("userStatus").value =
              user.status || "active";

            // Show user modal
            userModal.classList.add("active");
          })
          .catch((error) => {
            console.error("Error loading user data:", error);
          });
      }

      // Delete user
      function deleteUser(userId) {
        selectedItemId = userId;
        selectedItemType = "user";

        // Show delete confirmation modal
        deleteConfirmModal.classList.add("active");
      }

      // Save user (add or edit)
      function saveUserData() {
        const fullName = document.getElementById("userName").value.trim();
        const phoneNumber = document.getElementById("userPhone").value.trim();
        const localGovernment = document.getElementById("userLGA").value;
        const address = document.getElementById("userAddress").value.trim();
        const gender = document.querySelector(
          'input[name="userGender"]:checked'
        ).value;
        const password = document.getElementById("userPassword").value;
        const status = document.getElementById("userStatus").value;

        if (
          !fullName ||
          !phoneNumber ||
          !localGovernment ||
          !address ||
          !gender
        ) {
          alert("Please fill in all required fields");
          return;
        }

        if (isEditingUser) {
          // Update existing user
          const updates = {
            fullName,
            phoneNumber,
            localGovernment,
            address,
            gender,
            status,
            lastUpdated: Date.now(),
          };

          database
            .ref(`users/${selectedItemId}`)
            .update(updates)
            .then(() => {
              // Update password if provided
              if (password) {
                // Create email from phone number (matching signup approach)
                const email = phoneNumber + "@imostate.com";

                // Get user by email
                return auth
                  .fetchSignInMethodsForEmail(email)
                  .then((methods) => {
                    if (methods.length > 0) {
                      // User exists, update password
                      // Note: In a real app, you'd need admin SDK for this
                      console.log("Would update password for:", email);
                    }
                  });
              }
            })
            .then(() => {
              userModal.classList.remove("active");

              if (currentSection === "dashboard") {
                loadRecentUsers();
              } else if (currentSection === "users") {
                loadAllUsers();
              }
            })
            .catch((error) => {
              console.error("Error updating user:", error);
            });
        } else {
          // Add new user
          if (!password) {
            alert("Password is required for new users");
            return;
          }

          // Create email from phone number (matching signup approach)
          const email = phoneNumber + "@imostate.com";

          // Create user with email and password
          auth
            .createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
              // User created successfully
              const user = userCredential.user;

              // Save additional user data to Realtime Database
              return database.ref("users/" + user.uid).set({
                fullName,
                phoneNumber,
                localGovernment,
                address,
                gender,
                status,
                createdAt: firebase.database.ServerValue.TIMESTAMP,
              });
            })
            .then(() => {
              userModal.classList.remove("active");
              userForm.reset();

              if (currentSection === "dashboard") {
                loadRecentUsers();
                loadStats();
              } else if (currentSection === "users") {
                loadAllUsers();
              }
            })
            .catch((error) => {
              console.error("Error creating user:", error);
              alert(`Error: ${error.message}`);
            });
        }
      }

      // Setup event listeners
      function setupEventListeners() {
        // Navigation
        navItems.forEach((item) => {
          item.addEventListener("click", () => {
            const section = item.getAttribute("data-section");
            changeSection(section);
          });
        });

        // Logout
        logoutBtn.addEventListener("click", () => {
          auth.signOut().then(() => {
            window.location.href = "login.html";
          });
        });

        // View All Complaints button
        document
          .getElementById("viewAllComplaintsBtn")
          .addEventListener("click", () => {
            changeSection("complaints");
          });

        // View All Users button
        document
          .getElementById("viewAllUsersBtn")
          .addEventListener("click", () => {
            changeSection("users");
          });

        // Complaint tabs
        complaintTabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            complaintTabs.forEach((t) => t.classList.remove("active"));
            tab.classList.add("active");
            filterComplaints(tab.getAttribute("data-tab"));
          });
        });

        // User tabs
        userTabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            userTabs.forEach((t) => t.classList.remove("active"));
            tab.classList.add("active");
            filterUsers(tab.getAttribute("data-tab"));
          });
        });

        // Search complaints
        complaintSearch.addEventListener("input", () => {
          filterComplaints(currentComplaintsTab);
        });

        // Search users
        userSearch.addEventListener("input", () => {
          filterUsers(currentUsersTab);
        });

        // Complaint modal
        closeViewComplaintModal.addEventListener("click", () => {
          viewComplaintModal.classList.remove("active");
        });

        closeComplaintBtn.addEventListener("click", () => {
          viewComplaintModal.classList.remove("active");
        });

        // Update status modal
        updateStatusBtn.addEventListener("click", () => {
          updateStatusModal.classList.add("active");
        });

        closeUpdateStatusModal.addEventListener("click", () => {
          updateStatusModal.classList.remove("active");
        });

        cancelStatusUpdate.addEventListener("click", () => {
          updateStatusModal.classList.remove("active");
        });

        saveStatusUpdate.addEventListener("click", saveComplaintStatusUpdate);

        // User modal
        addUserBtn.addEventListener("click", () => {
          isEditingUser = false;
          userModalTitle.textContent = "Add New User";
          userForm.reset();
          document.getElementById("userPassword").required = true;
          document.getElementById("userPassword").placeholder =
            "Enter password";
          userModal.classList.add("active");
        });

        closeUserModal.addEventListener("click", () => {
          userModal.classList.remove("active");
        });

        cancelUser.addEventListener("click", () => {
          userModal.classList.remove("active");
        });

        saveUser.addEventListener("click", saveUserData);

        // Delete confirmation modal
        closeDeleteConfirmModal.addEventListener("click", () => {
          deleteConfirmModal.classList.remove("active");
        });

        cancelDelete.addEventListener("click", () => {
          deleteConfirmModal.classList.remove("active");
        });

        confirmDelete.addEventListener("click", confirmDeleteItem);
      }

      // Change active section
      function changeSection(section) {
        currentSection = section;

        // Update navigation
        navItems.forEach((item) => {
          if (item.getAttribute("data-section") === section) {
            item.classList.add("active");
          } else {
            item.classList.remove("active");
          }
        });

        // Hide all sections
        contentSections.forEach((section) => {
          section.style.display = "none";
        });

        // Show selected section
        document.getElementById(section + "Section").style.display = "block";

        // Reset pagination
        currentPage = 1;

        // Load section data
        if (section === "complaints") {
          loadAllComplaints();
        } else if (section === "users") {
          loadAllUsers();
        } else if (section === "analytics") {
          loadAnalyticsData();
        }
      }

      // Load analytics data
      function loadAnalyticsData() {
        // This would be implemented with real data in a production environment
        // For demo purposes, we'll use placeholder data
        document.getElementById("newUsersAnalytics").textContent = "124";
        document.getElementById("newComplaintsAnalytics").textContent = "87";
        document.getElementById("resolutionRateAnalytics").textContent = "68%";
        document.getElementById("avgResponseTimeAnalytics").textContent = "8h";

        // In a real implementation, you would:
        // 1. Query Firebase for relevant data
        // 2. Process the data for analytics
        // 3. Use a charting library like Chart.js to render charts
      }

      // Make functions available globally
      window.viewComplaint = viewComplaint;
      window.editComplaintStatus = editComplaintStatus;
      window.deleteComplaint = deleteComplaint;
      window.viewUser = viewUser;
      window.editUser = editUser;
      window.deleteUser = deleteUser;
      window.submitAdminReply = submitAdminReply;
      window.changePage = changePage;

      // Initialize the app
      initApp();
    </script>
  </body>
</html>
